<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-74PGK3MG17"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  // ุชุญุฏูุฏ ุงููุตุฏุฑ GitHub
  gtag('config', 'G-74PGK3MG17', {
    campaign_source: 'github',
    page_location: window.location.href
  });
</script>


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>ุญุงุณุจุฉ ุชูููุฉ ุงูุฌูุฏู</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f2f4f8;
    color: #333;
    padding: 1rem;
    display: flex;
    justify-content: center;
  }

  .container {
    background: #fff;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 1.5rem;
    max-width: 680px;
    width: 100%;
    box-sizing: border-box;
  }

  h1 {
    text-align: center;
    margin-bottom: 1.5rem;
    font-size: 1.5rem;
  }

  input[type="text"],
  select {
    width: 100%;
    padding: 0.6rem;
    margin-top: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    box-sizing: border-box;
    direction: ltr;
    font-size: 1rem;
  }

  .row,
  .select-row {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .results {
    margin-top: 1.5rem;
    padding: 1rem;
    background: #e9f5ec;
    border-radius: 0.5rem;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .results div {
    margin-top: 0.5rem;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  #unitTotalCost {
    margin-top: 1rem;
    font-weight: bold;
    font-size: 1.1rem;
    color: #1c7c38;
  }

  .cost-display {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    gap: 0.5rem;
    font-weight: bold;
    font-size: 1.1rem;
    margin-top: 1rem;
  }

  .cost-display > div {
    flex: 1 1 45%;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }

  /* ุชุฃุซูุฑุงุช ุงูุชุญูุฉ ุงูุฃุณุทูุฑูุฉ */
  .artifact-active {
    background: linear-gradient(135deg, #fff9e6 0%, #fff5d6 50%, #fff0c4 100%);
    border: 2px solid #ffd700;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
    position: relative;
  }

  .artifact-active::before {
    content: "โจ";
    position: absolute;
    top: -8px;
    right: -8px;
    font-size: 16px;
    animation: sparkle 2s ease-in-out infinite;
  }

  @keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.8; }
    50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
  }

  .artifact-active .cost-display {
    background: linear-gradient(135deg, #fff9e6 0%, #fff5d6 100%);
    border-radius: 0.5rem;
    padding: 0.5rem;
    margin-top: 0.5rem;
  }

  .artifact-active #unitTotalCost {
    color: #d4af37;
    text-shadow: 0 0 4px rgba(212, 175, 55, 0.3);
  }

  /* ุชุฃุซูุฑุงุช ุงูุดูู ุจููุณ */
  #reduceCostCheckbox:checked + label {
    color: #d4af37;
    font-weight: bold;
    text-shadow: 0 0 2px rgba(212, 175, 55, 0.3);
  }

  #reduceCostCheckbox:checked {
    accent-color: #ffd700;
    transform: scale(1.1);
    transition: all 0.3s ease;
  }

  /* ุชุฃุซูุฑุงุช ุงููุชุงุฆุฌ ุนูุฏ ุชูุนูู ุงูุชุญูุฉ */
  .artifact-active .results {
    background: linear-gradient(135deg, #f0f8e6 0%, #e8f5d6 100%);
    border: 1px solid #ffd700;
    box-shadow: 0 0 6px rgba(255, 215, 0, 0.2);
  }

  .artifact-active .results div {
    color: #2d5016;
  }

  input:enabled {
    border: 2px solid #007bff;
    background-color: #ffffff;
    outline: none;
    caret-color: #007bff;
    box-shadow: 0 0 4px rgba(0, 123, 255, 0.4);
  }

  input:disabled {
    border: 1px solid #ccc;
    background-color: #f8f9fa;
    color: #888;
  }

  @media (min-width: 768px) {
    input[type="text"],
    select {
      font-size: 1rem;
    }

    .cost-display > div {
      flex: 1;
    }
  }
</style>

</head>
<body>
  <div class="container">
     

    <div class="select-row">
      <select id="tribeSelect" onchange="populateTroops()">
        <option value="">-- ุงุฎุชุฑ ุงููุจููุฉ ๐ฐ --</option>
        <option value="german">ุงูุฌุฑูุงู</option>
        <option value="roman">ุงูุฑููุงู</option>
        <option value="gaul">ุงูุฅุบุฑูู</option>
        <option value="egyptian">ุงููุฑุงุนูุฉ</option>
        <option value="hun">ุงููุบูู</option>
        <option value="spartan">ุฃุณุจุฑุทุฉ</option>
        <option value="viking">ุงูฺคุงูููุฌ</option>
      </select>

      <select id="troopSelect" onchange="setTroopCosts()">
        <option value="">-- ุงุฎุชุฑ ููุน ุงูุฌูุฏู โ๏ธ --</option>
      </select>
    </div>

         <div class="cost-display">
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="woodCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="clayCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="ironCostText">0</span></div>
       <div><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> <span id="wheatCostText">0</span></div>
     </div>

<div id="unitTotalCost"><img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ุชูููุฉ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> ูุฌููุน ุชูููุฉ ุงูุฌูุฏู: 0</div>

<!-- โ ุฎูุงุฑุงุช ุงูุญุณุงุจ ุฃููุงู -->
<div style="margin-bottom: 10px; font-size: 14px;">
  <p>ุงูุญุณุงุจ ูุชู ุนู ุทุฑูู:</p>
<input type="radio" name="calcMode" value="resources" checked onchange="updateInputFieldsState(); recalculate()">  ุงูููุงุฑุฏ
<input type="radio" name="calcMode" value="troops" onchange="updateInputFieldsState(); recalculate()">  ุนุฏุฏ ุงูุฌููุฏ
<input type="radio" name="calcMode" value="gold" onchange="updateInputFieldsState(); recalculate()">   ุงูุฐูุจ
<label>
  <input type="checkbox" id="reduceCostCheckbox" onchange="toggleArtifactEffects(); setTroopCosts(); recalculate()">
  ๐บ ุงูุชุญูุฉ ุงูุฃุณุทูุฑูุฉ (30% ููุงุฑุฏ ุฃูู)</label>
</div>

<!-- ๐ข ูุฏุฎูุงุช ุงูุญุณุงุจ -->
<div class="row">
<input type="text" id="totalResources" placeholder="ุฅุฌูุงูู ุงูููุงุฑุฏ" oninput="formatInputWithCommas(this); onInputHandler('resources')">
<input type="text" id="customTroopCount" placeholder="ุนุฏุฏ ุงูุฌููุฏ" oninput="formatInputWithCommas(this); onInputHandler('troops')">
<input type="text" id="goldInput" placeholder=" ุฃุฏุฎู ุนุฏุฏ ุงูุฐูุจ" oninput="formatInputWithCommas(this); onInputHandler('gold')">
</div>

    <div class="results" id="results">
      <div id="marketGoldValue">๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0</div>
      <div id="goldCost">๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;"></div>
      <div id="troopsCount">๐ฅ ูููู ุชุฏุฑูุจ: 0 ุฌูุฏู</div>
             <div id="totalWood"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: 0</div>
       <div id="totalClay"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: 0</div>
       <div id="totalIron"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: 0</div>
       <div id="totalWheat"><img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: 0</div>
       <div id="totalResourcesUsed"><img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: 0</div>
    </div>
      <button onclick="resetAll()" style="margin-top: 1rem; padding: 0.5rem 1rem; border: none; border-radius: 0.5rem; background-color: #e74c3c; color: white; font-size: 1rem; cursor: pointer;">
๐ ุฅุนุงุฏุฉ ุถุจุท ุงูุตูุญุฉ
</button>
     <p> Disc+</p>
<a href="https://discord.gg/tQSsTrdP" target="_blank">
  <img src="https://seeklogo.com/images/D/discord-color-logo-E5E6DFEF80-seeklogo.com.png" 
       alt="Discord" 
       style="width: 40px; height: 40px;">
</a>
  </div>

  <script>
    const troopData = {
      german: [
        { name: 'ููุงุชู ุจูุฑุงูุฉ', cost: [95, 75, 40, 40], marketRate: 800 },
        { name: 'ููุงุชู ุจุฑูุญ', cost: [130, 120, 170, 70], marketRate: 588 },
        { name: 'ููุงุชู ุจูุฃุณ', cost: [130, 120, 170, 70], marketRate: 408 },
        { name: 'ุงููุดุงู', cost: [160, 100, 50, 50], marketRate: 555 },
        { name: 'ููุงุชู ุงูููุตุฑ', cost: [370, 270, 290, 75], marketRate: 199 },
        { name: 'ูุฑุณุงู ุงูุฌุฑูุงู', cost: [450, 515, 480, 150], marketRate: 131 },
        { name: 'ูุญุทูุฉ ุงูุฃุจูุงุจ', cost: [1000, 300, 350, 300], marketRate: 110 },
        { name: 'ุงููููุงุน', cost: [900, 1200, 600, 60], marketRate: 70 },
        { name: 'ุงูุฒุนูู', cost: [35500, 26500, 25000, 80] },
        { name: 'ูุณุชูุทู', cost: [7200, 5500, 5800, 100] }
      ],
      roman: [
        { name: 'ุฌูุฏู ุฃูู', cost: [120, 100, 180, 40], marketRate: 454 },
        { name: 'ุญุฑุงุณ ุงูุฃูุจุฑุงุทูุฑ', cost: [100, 130, 160, 70], marketRate: 434 },
        { name: 'ุฌูุฏู ููุงุฌู', cost: [150, 160, 210, 80], marketRate: 333 },
        { name: 'ูุฑูุฉ ุชุฌุณุณ', cost: [140, 160, 20, 40], marketRate: 555 },
        { name: 'ุณูุงุญ ุงููุฑุณุงู', cost: [550, 440, 320, 100], marketRate: 141 },
        { name: 'ูุฑุณุงู ููุตุฑ', cost: [550, 640, 800, 180], marketRate: 92 },
        { name: 'ูุจุด', cost: [900, 360, 500, 70], marketRate: 109 },
        { name: 'ุงููููุงุน ุงููุงุฑู', cost: [950, 1350, 600, 90], marketRate: 66 },
        { name: 'ุญููู', cost: [30750, 27200, 45000, 37500] },
        { name: 'ูุณุชูุทู', cost: [5800, 5300, 7200, 5500] }
      ],
      gaul: [
        { name: 'ุงููุชูุจุฉ', cost: [100, 110, 50, 30], marketRate: 645 },
        { name: 'ูุจุงุฑุฒ', cost: [140, 150, 185, 60], marketRate: 380 },
        { name: 'ุงููุณุชูุดู', cost: [170, 150, 20, 40], marketRate: 530 },
        { name: 'ุฑุนุฏ ุงูุฅุบุฑูู', cost: [350, 450, 230, 60], marketRate: 190 },
        { name: 'ูุฑุณุงู ุงูุณูุช', cost: [360, 330, 280, 120], marketRate: 190 },
        { name: 'ูุฑุณุงู ุงูููุฏูุงูุฑ', cost: [500, 620, 675, 170], marketRate: 101 },
        { name: 'ูุญุทูุฉ ุงูุงุจูุงุจ', cost: [950, 555, 330, 75], marketRate: 104 },
        { name: 'ุงููููุงุน ุงูุญุฑุจู', cost: [960, 1450, 630, 90], marketRate: 63 },
        { name: 'ุฑุฆูุณ', cost: [30750, 45400, 31000, 37500] },
        { name: 'ูุณุชูุทู', cost: [5500, 7000, 5300, 4900] }
      ],
      egyptian: [
        { name: 'ููููุดูุง', cost: [45, 60, 30, 15], marketRate: 1333 },
        { name: 'ุญุงุฑุณ ุงูุฑูุงุฏ', cost: [115, 100, 145, 60], marketRate: 476 },
        { name: 'ูุญุงุฑุจ ุฎุงุจุงุด', cost: [170, 180, 220, 80], marketRate: 307 },
        { name: 'ุงููุณุชุทูุน', cost: [170, 150, 20, 40], marketRate: 526 },
        { name: 'ุญุงุฑุณ ุฃูุฌูุฑ', cost: [360, 330, 280, 120], marketRate: 183 },
        { name: 'ุนุฑุจุฉ ุฑุดุจ', cost: [450, 560, 610, 180], marketRate: 111 },
        { name: 'ูุฏููุงุช', cost: [900, 360, 500, 70] },
        { name: 'ููุฌููู ูุงุฑู', cost: [995, 575, 340, 80] },
        { name: 'ุฃููุฑ ุญุงุชู', cost: [34000, 50000, 34000, 42000] },
        { name: 'ุงููุณุชูุทู', cost: [4560, 5890, 4370, 4180] }
      ],
      hun: [
        { name: 'ูุฑุชุฒูุฉ', cost: [130, 80, 40, 40], marketRate: 689 },
        { name: 'ุฑุงูู ุงูุณูุงู', cost: [140, 110, 60, 60], marketRate: 540 },
        { name: 'ูุฑุงูุจ', cost: [170, 150, 20, 40], marketRate: 526 },
        { name: 'ูุงุฑุณ ุงูุณููุจ', cost: [290, 370, 190, 45], marketRate: 223 },
        { name: 'ุงููููุงุต', cost: [320, 350, 330, 50], marketRate: 190 },
        { name: 'ุตุนููู', cost: [450, 560, 610, 140], marketRate: 113 },
        { name: 'ูุฏูู ุฑุฃุณ ูุจุด', cost: [1060, 330, 360, 70], marketRate: 109 },
        { name: 'ุงูููุฌููู', cost: [950, 1280, 620, 60], marketRate: 68 },
        { name: 'ุฎุงู', cost: [46125, 40800, 67500, 65250] },
        { name: 'ูุณุชูุทู', cost: [8700, 7950, 10800, 8250] }
      ],
      spartan: [
        { name: 'ููุจููุช', cost: [110, 185, 110, 35], marketRate: 454 },
        { name: 'ุฌุงุณูุณ', cost: [185, 150, 35, 75], marketRate: 449 },
        { name: 'ูุญุงุฑุจ ุงูุฏุฑูุน', cost: [145, 95, 245, 45], marketRate: 377 },
        { name: 'ุซูุฑููู', cost: [130, 200, 400, 65], marketRate: 251 },
        { name: 'ูุงุฑุณ ุฅูุจูุฏุง', cost: [555, 445, 330, 110], marketRate: 138 },
        { name: 'ูุงุฑุณ ููุฑูุซู', cost: [660, 495, 995, 165], marketRate: 86 },
        { name: 'ูุจุด', cost: [525, 260, 790, 130], marketRate: 117 },
        { name: 'ุงูุนุฑูุงุฏุฉ', cost: [550, 1240, 825, 135], marketRate: 72 },
        { name: 'ุฅูููุฑ', cost: [33450, 30665, 36240, 13935] },
        { name: 'ุงููุณุชูุทู', cost: [5115, 5580, 6045, 3255] }
      ],
      viking: [
        { name: 'ุงูุฑููู', cost: [95, 90, 70, 45], marketRate: 688 },
        { name: 'ุนุฐุฑุงุก ุงูุฏุฑุน', cost: [125, 80, 85, 40], marketRate: 590 },
        { name: 'ุงููุฌูุงู', cost: [130, 120, 110, 80], marketRate: 470 },
        { name: 'ุนูู ูุงููุฏุงู', cost: [155, 95, 50, 50], marketRate: 570 },
        { name: 'ูุงุฑุณ ููุณูุงุฑู', cost: [385, 295, 290, 85], marketRate: 180 },
        { name: 'ุงูฺคุงูููุฑู', cost: [475, 535, 515, 100], marketRate: 122 },
        { name: 'ูุจุด', cost: [950, 325, 375, 70], marketRate: 116 },
        { name: 'ููุฌููู', cost: [850, 1225, 625, 60], marketRate: 72 },
        { name: 'ุงูุฅูุฑู', cost: [35500, 26600, 25000, 27200] },
        { name: 'ูุณุชูุทู', cost: [5800, 4600, 4800, 4800] }
      ]
    };

  function populateTroops() {
    const tribe = document.getElementById('tribeSelect').value;
    const troopSelect = document.getElementById('troopSelect');
    troopSelect.innerHTML = '<option value="">-- ุงุฎุชุฑ ููุน ุงูุฌูุฏู โ๏ธ --</option>';

    clearResults();

    if (!tribe || !troopData[tribe] || troopData[tribe].length === 0) {
      return;
    }

    troopData[tribe].forEach(troop => {
      const opt = document.createElement('option');
      opt.value = troop.cost.join(',');
      opt.textContent = troop.name;
      troopSelect.appendChild(opt);
    });
  }

function clearResults() {
  document.getElementById('woodCostText').textContent = '0';
  document.getElementById('clayCostText').textContent = '0';
  document.getElementById('ironCostText').textContent = '0';
  document.getElementById('wheatCostText').textContent = '0';
  document.getElementById('unitTotalCost').innerHTML = '<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ุชูููุฉ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> ูุฌููุน ุชูููุฉ ุงูุฌูุฏู: 0';
  document.getElementById('goldCost').innerHTML = '๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">';
  document.getElementById('troopsCount').textContent = '๐ฅ ูููู ุชุฏุฑูุจ: 0 ุฌูุฏู';
  document.getElementById('totalWood').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: 0';
  document.getElementById('totalClay').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: 0';
  document.getElementById('totalIron').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: 0';
  document.getElementById('totalWheat').innerHTML = '<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: 0';
  document.getElementById('totalResourcesUsed').innerHTML = '<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: 0';
  document.getElementById('marketGoldValue').textContent = '๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0';
}

function setTroopCosts() {
  const select = document.getElementById('troopSelect');
  if (!select.value) {
    clearResults();
    return;
  }

  const values = select.value.split(',');
  if (values.length !== 4) {
    clearResults();
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;
  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  document.getElementById('woodCostText').textContent = formatNumber(wood);
  document.getElementById('clayCostText').textContent = formatNumber(clay);
  document.getElementById('ironCostText').textContent = formatNumber(iron);
  document.getElementById('wheatCostText').textContent = formatNumber(wheat);

  const sum = wood + clay + iron + wheat;
  document.getElementById('unitTotalCost').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ุชูููุฉ" style="width: 20px; height: 20px; vertical-align: middle; margin-left: 5px;"> ูุฌููุน ุชูููุฉ ุงูุฌูุฏู: ${formatNumber(sum)}`;

  recalculate();
}

function recalculate() {
  const calcMode = getSelectedCalcMode();
  const troopSelect = document.getElementById('troopSelect');

  if (!troopSelect.value) {
    return;
  }

  if (calcMode === 'resources' && document.getElementById('totalResources').value.trim() !== '') {
    updateEstimatedTroops();
  } else if (calcMode === 'troops' && document.getElementById('customTroopCount').value.trim() !== '') {
    updateResourceTotalFromTroops();
  } else if (calcMode === 'gold' && document.getElementById('goldInput').value.trim() !== '') {
    updateFromGold();
  }
}

function updateResourceTotalFromTroops() {
  if (getSelectedCalcMode() !== 'troops') return;

  const countInput = document.getElementById('customTroopCount');
  const totalResourcesInput = document.getElementById('totalResources');
  const goldInput = document.getElementById('goldInput');
  const select = document.getElementById('troopSelect');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  const count = parseInt(countInput.value.replace(/,/g, '') || '0');
  const values = select.value.split(',');

  if (values.length !== 4 || count === 0) {
    totalResourcesInput.value = '';
    goldInput.value = '';
    document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: 0 ุฌูุฏู`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: 0`;
    document.getElementById('marketGoldValue').textContent = `๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const perUnitCost = wood + clay + iron + wheat;
  const totalCost = count * perUnitCost;
  const goldCost = Math.ceil(totalCost / 55000);

  totalResourcesInput.value = formatNumber(totalCost);
  goldInput.value = formatNumber(goldCost);

  document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: ${formatNumber(goldCost)} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: ${formatNumber(count)} ุฌูุฏู`;

  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: ${formatNumber(count * wood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: ${formatNumber(count * clay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: ${formatNumber(count * iron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: ${formatNumber(count * wheat)}`;

  const totalUsed = (count * wood) + (count * clay) + (count * iron) + (count * wheat);
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: ${formatNumber(totalUsed)}`;

  updateMarketValue(goldCost, select.selectedOptions[0].textContent, count);
}

function updateEstimatedTroops() {
  if (getSelectedCalcMode() !== 'resources') return;

  const totalInput = document.getElementById('totalResources');
  const troopCountInput = document.getElementById('customTroopCount');
  const goldInput = document.getElementById('goldInput');
  const select = document.getElementById('troopSelect');
  const total = parseInt(totalInput.value.replace(/,/g, '') || '0');
  const values = select.value.split(',');
  const hasArtifact = document.getElementById('reduceCostCheckbox')?.checked;

  if (values.length !== 4 || total === 0) {
    troopCountInput.value = '';
    goldInput.value = '';
    document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: 0 ุฌูุฏู`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: 0`;
    document.getElementById('marketGoldValue').textContent = `๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (hasArtifact) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const totalCostPerTroop = wood + clay + iron + wheat;
  const count = Math.floor(total / totalCostPerTroop);
  const totalWood = count * wood;
  const totalClay = count * clay;
  const totalIron = count * iron;
  const totalWheat = count * wheat;
  const totalUsed = totalWood + totalClay + totalIron + totalWheat;

  troopCountInput.value = formatNumber(count);
  goldInput.value = formatNumber(Math.ceil(totalUsed / 55000));

  document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: ${formatNumber(Math.ceil(totalUsed / 55000))} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: ${formatNumber(count)} ุฌูุฏู`;
  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: ${formatNumber(totalWood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: ${formatNumber(totalClay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: ${formatNumber(totalIron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: ${formatNumber(totalWheat)}`;
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: ${formatNumber(totalUsed)}`;

  updateMarketValue(Math.ceil(totalUsed / 55000), select.selectedOptions[0].textContent, count);
}

function updateFromGold() {
  if (getSelectedCalcMode() !== 'gold') return;

  const goldInput = document.getElementById('goldInput');
  const totalResourcesInput = document.getElementById('totalResources');
  const troopCountInput = document.getElementById('customTroopCount');
  const select = document.getElementById('troopSelect');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  const rawGold = goldInput.value.replace(/,/g, '').trim();

  if (rawGold === '' || parseInt(rawGold) === 0) {
    totalResourcesInput.value = '';
    troopCountInput.value = '';
    document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: 0 <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
    document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: 0 ุฌูุฏู`;
    document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: 0`;
    document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: 0`;
    document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: 0`;
    document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: 0`;
    document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: 0`;
    document.getElementById('marketGoldValue').textContent = `๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0`;

    updateMarketValue(0, '', 0);
    return;
  }

  const gold = parseInt(rawGold) || 0;
  const values = select.value.split(',');

  if (values.length !== 4) return;

  const totalResources = gold * 55000;
  totalResourcesInput.value = formatNumber(totalResources);

  let wood = parseInt(values[0]);
  let clay = parseInt(values[1]);
  let iron = parseInt(values[2]);
  let wheat = parseInt(values[3]);

  if (isArtifactActive) {
    wood = Math.floor(wood * 0.7);
    clay = Math.floor(clay * 0.7);
    iron = Math.floor(iron * 0.7);
    wheat = Math.floor(wheat * 0.7);
  }

  const perUnitCost = wood + clay + iron + wheat;

  const estimatedTroops = Math.floor(totalResources / perUnitCost);
  troopCountInput.value = formatNumber(estimatedTroops);

  updateMarketValue(gold, select.selectedOptions[0].textContent, estimatedTroops);

  const totalUsedWood = estimatedTroops * wood;
  const totalUsedClay = estimatedTroops * clay;
  const totalUsedIron = estimatedTroops * iron;
  const totalUsedWheat = estimatedTroops * wheat;

  document.getElementById('goldCost').innerHTML = `๐ฐ ุชูููุฉ ุงูููุงุฑุฏ ุจุงูุฐูุจ: ${formatNumber(gold)} <img src="https://utatar.com/assets/default/img/a/gold.gif" style="vertical-align: middle;">`;
  document.getElementById('troopsCount').textContent = `๐ฅ ูููู ุชุฏุฑูุจ: ${formatNumber(estimatedTroops)} ุฌูุฏู`;
  document.getElementById('totalWood').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/lumber_tiny.png" alt="ุฎุดุจ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุฎุดุจ: ${formatNumber(totalUsedWood)}`;
  document.getElementById('totalClay').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/clay_tiny.png" alt="ุทูู" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุทูู: ${formatNumber(totalUsedClay)}`;
  document.getElementById('totalIron').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/iron_tiny.png" alt="ุญุฏูุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูุญุฏูุฏ: ${formatNumber(totalUsedIron)}`;
  document.getElementById('totalWheat').innerHTML = `<img src="https://gpack.traviantop.com/a5232e5f/mainPage/img_rtl/general/resources/crop_small.png" alt="ููุญ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุงูููุญ: ${formatNumber(totalUsedWheat)}`;
  document.getElementById('totalResourcesUsed').innerHTML = `<img src="https://testtrav.ct.ws/oie_U5bz9wzsOkhD.png" alt="ููุงุฑุฏ" style="width: 16px; height: 16px; vertical-align: middle; margin-left: 5px;"> ุฅุฌูุงูู ุงูููุงุฑุฏ: ${formatNumber(totalUsedWood + totalUsedClay + totalUsedIron + totalUsedWheat)}`;
}

function formatNumber(num) {
  return num.toLocaleString('en-US');
}

function resetAll() {
  clearResults();

  document.getElementById('totalResources').value = '';
  document.getElementById('customTroopCount').value = '';
  document.getElementById('goldInput').value = '';
  document.getElementById('reduceCostCheckbox').checked = false;

  const tribeSelect = document.getElementById('tribeSelect');
  const troopSelect = document.getElementById('troopSelect');

  tribeSelect.selectedIndex = 0;
  troopSelect.innerHTML = '<option value="">-- ุงุฎุชุฑ ููุน ุงูุฌูุฏู โ๏ธ --</option>';

  document.querySelector('input[name="calcMode"][value="resources"]').checked = true;

  updateInputFieldsState();

  toggleArtifactEffects();
}

function formatInputWithCommas(input) {
  let value = input.value.replace(/,/g, '');
  if (value === '') {
    input.value = '';
    return;
  }
  if (!/^\d+$/.test(value)) {
    value = value.replace(/\D/g, '');
  }
  input.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}

function getSelectedCalcMode() {
  const radios = document.getElementsByName('calcMode');
  for (let radio of radios) {
    if (radio.checked) return radio.value;
  }
  return null;
}

function onInputHandler(type) {
  const calcMode = getSelectedCalcMode();
  if (calcMode !== type) return;

  if (type === 'resources') {
    updateEstimatedTroops();
  } else if (type === 'troops') {
    updateResourceTotalFromTroops();
  } else if (type === 'gold') {
    updateFromGold();
  }
}

function updateMarketValue(goldCount, troopName, troopCount) {
  const tribe = document.getElementById('tribeSelect').value;
  if (!tribe || !troopData[tribe] || goldCount === 0) {
    document.getElementById('marketGoldValue').textContent = '๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: 0';
    return;
  }

  const troop = troopData[tribe].find(t => t.name === troopName);
  if (!troop || !troop.marketRate) {
    document.getElementById('marketGoldValue').textContent = '๐ธ ุชูููุฉ ุงูุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู ุจุงูุฐูุจ: ุบูุฑ ูุชููุฑุฉ';
    return;
  }

  const troopsByGold = goldCount * troop.marketRate;
  document.getElementById('marketGoldValue').textContent = `๐ธ ${formatNumber(goldCount)} ุฐูุจ = ${formatNumber(troopsByGold)} ุฌูุฏู ูู ุณูู ุงููุญุงุฑุจูู`;
}

function updateInputFieldsState() {
  const mode = getSelectedCalcMode();
  const goldInput = document.getElementById('goldInput');
  const troopCountInput = document.getElementById('customTroopCount');
  const totalResourcesInput = document.getElementById('totalResources');

  goldInput.disabled = (mode !== 'gold');
  troopCountInput.disabled = (mode !== 'troops');
  totalResourcesInput.disabled = (mode !== 'resources');
}

function toggleArtifactEffects() {
  const container = document.querySelector('.container');
  const isArtifactActive = document.getElementById('reduceCostCheckbox').checked;

  if (isArtifactActive) {
    container.classList.add('artifact-active');
  } else {
    container.classList.remove('artifact-active');
  }
}

window.addEventListener('DOMContentLoaded', () => {
  updateInputFieldsState();
  toggleArtifactEffects();
});
</script>
   


</body>
</html>
